<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Announcements - BHCMS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script type="module" src="https://unpkg.com/heroicons@2.1.1/dist/solid.js"></script>
    <script type="module" src="https://unpkg.com/heroicons@2.1.1/dist/outline.js"></script>
    
    <style>
        /* Apply Inter font globally */
        html {
            font-family: 'Inter', sans-serif;
        }

        /* --- Collapsible Sidebar Styles (Matches Admin Dashboard) --- */
        #sidebar-nav::-webkit-scrollbar { width: 6px; }
        #sidebar-nav::-webkit-scrollbar-thumb { background: #4a5568; border-radius: 3px; }
        #sidebar-nav::-webkit-scrollbar-track { background: #2d3748; }
        #sidebar-nav { scrollbar-width: thin; scrollbar-color: #4a5568 #2d3748; }
        #sidebar {
            transition: width 0.3s ease-in-out, transform 0.3s ease-in-out;
        }
        #main-content {
            transition: margin-left 0.3s ease-in-out;
        }

        @media (min-width: 1024px) {
            /* Collapsed "mini" state */
            #sidebar { width: 5rem; z-index: 50; }
            #main-content { margin-left: 5rem; }
            .sidebar-text, .sidebar-header-text, .sidebar-dropdown-arrow {
                display: none; opacity: 0; transition: opacity 0.2s ease-in-out;
            }
            .sidebar-link-container, .sidebar-header { justify-content: center; }
            #content-menu, #user-menu { display: none !important; }
            
            /* Expanded "hover" state */
            #sidebar:hover { width: 16rem; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
            /* Note: We keep main-content margin the same on hover to avoid content shifting */
            #sidebar:hover ~ #main-content { margin-left: 5rem; } 
            
            #sidebar:hover .sidebar-text, 
            #sidebar:hover .sidebar-header-text, 
            #sidebar:hover .sidebar-dropdown-arrow {
                display: inline-block; opacity: 1; transition-delay: 0.1s;
            }
            #sidebar:hover .sidebar-link-container, #sidebar:hover .sidebar-header { justify-content: flex-start; }
            #sidebar:hover #content-menu, #sidebar:hover #user-menu { display: block !important; }
        }

        @media (max-width: 1023px) {
            /* Mobile/Tablet State */
            #sidebar { width: 16rem; transform: translateX(-100%); z-index: 60; }
            #main-content { margin-left: 0; }
            body.sidebar-open #sidebar { transform: translateX(0); }
            .sidebar-text, .sidebar-header-text, .sidebar-dropdown-arrow { display: inline-block; opacity: 1; }
            .sidebar-link-container, .sidebar-header { justify-content: flex-start; }
            #sidebar-backdrop { transition: opacity 0.3s ease-in-out; }
            body:not(.sidebar-open) #sidebar-backdrop { opacity: 0; pointer-events: none; }
            body.sidebar-open #sidebar-backdrop { opacity: 1; pointer-events: auto; }
        }

        /* Modal Styles */
        .modal { transition: opacity 0.3s ease, visibility 0.3s ease; }
        .modal-panel { transition: transform 0.3s ease, opacity 0.3s ease; }
    </style>
</head>
<body class="bg-gray-100">
    <div class="flex h-screen bg-gray-100">

        <aside id="sidebar" class="fixed inset-y-0 left-0 flex flex-col h-screen bg-gray-800 text-gray-200">
            <div class="sidebar-header flex items-center p-4 h-16 border-b border-gray-700 flex-shrink-0">
                <a href="AdminDashboard.html" class="flex items-center space-x-2 overflow-hidden">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8 text-teal-400 flex-shrink-0">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M21 7.5l-9-5.25L3 7.5m18 0l-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9" />
                    </svg>
                    <span class="text-xl font-bold text-white sidebar-header-text whitespace-nowrap">
                        Admin
                    </span>
                </a>
                <button id="sidebar-close-btn" class="hidden ml-auto p-1 text-gray-400 hover:text-white">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>

            <nav id="sidebar-nav" class="flex-1 overflow-y-auto">
                <ul class="py-4">
                    <li>
                        <a href="AdminDashboard.html" class="flex items-center px-4 py-3 text-gray-300 hover:bg-gray-700 hover:text-white">
                            <span class="sidebar-link-container flex items-center w-full">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 mr-3 flex-shrink-0">
                                    <path fill-rule="evenodd" d="M3 6a3 3 0 013-3h2.25a3 3 0 013 3v2.25a3 3 0 01-3 3H6a3 3 0 01-3-3V6zm9.75 0a3 3 0 013-3H18a3 3 0 013 3v2.25a3 3 0 01-3 3h-2.25a3 3 0 01-3-3V6zM3 15.75a3 3 0 013-3h2.25a3 3 0 013 3V18a3 3 0 01-3 3H6a3 3 0 01-3-3v-2.25zm9.75 0a3 3 0 013-3H18a3 3 0 013 3V18a3 3 0 01-3 3h-2.25a3 3 0 01-3-3v-2.25z" clip-rule="evenodd" />
                                </svg>
                                <span class="sidebar-text whitespace-nowrap">Dashboard</span>
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="Appointment.html" class="flex items-center px-4 py-3 text-gray-300 hover:bg-gray-700 hover:text-white">
                            <span class="sidebar-link-container flex items-center w-full">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 mr-3 flex-shrink-0">
                                    <path fill-rule="evenodd" d="M6.75 2.25A.75.75 0 017.5 3v1.5h9V3A.75.75 0 0118 3v1.5h.75a3 3 0 013 3v11.25a3 3 0 01-3 3H5.25a3 3 0 01-3-3V7.5a3 3 0 013-3H6V3a.75.75 0 01.75-.75zM5.25 6.75c-.621 0-1.125.504-1.125 1.125V18a1.125 1.125 0 001.125 1.125h13.5A1.125 1.125 0 0019.875 18V7.875c0-.621-.504-1.125-1.125-1.125H5.25z" clip-rule="evenodd" />
                                    <path d="M10.5 12a.75.75 0 000 1.5h3a.75.75 0 000-1.5h-3z" />
                                </svg>
                                <span class="sidebar-text whitespace-nowrap">Appointments</span>
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="PatientRecords.html" class="flex items-center px-4 py-3 text-gray-300 hover:bg-gray-700 hover:text-white">
                            <span class="sidebar-link-container flex items-center w-full">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 mr-3 flex-shrink-0">
                                    <path d="M11.7 2.25c.218-.579 1.02-.579 1.238 0l.4 1.063a.75.75 0 00.728.529h1.096c.606 0 1.01.657.733 1.183l-.9.45a.75.75 0 00-.27.803l.4 1.063c.218.579-.188 1.272-.733 1.183h-1.096a.75.75 0 00-.728.529l-.4 1.063c-.218.579-1.02.579-1.238 0l-.4-1.063a.75.75 0 00-.728-.529H7.94c-.606 0-1.01-.657-.733-1.183l.9-.45a.75.75 0 00.27-.803l-.4-1.063c-.218-.579.188-1.272.733-1.183h1.096a.75.75 0 00.728-.529l.4-1.063z" />
                                    <path fill-rule="evenodd" d="M12 21a9 9 0 100-18 9 9 0 000 18zm0-1.5c-4.142 0-7.5-3.358-7.5-7.5s3.358-7.5 7.5-7.5 7.5 3.358 7.5 7.5-3.358 7.5-7.5 7.5z" clip-rule="evenodd" />
                                </svg>
                                <span class="sidebar-text whitespace-nowrap">Patient Records</span>
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="MedicalInventory.html" class="flex items-center px-4 py-3 text-gray-300 hover:bg-gray-700 hover:text-white">
                            <span class="sidebar-link-container flex items-center w-full">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 mr-3 flex-shrink-0">
                                    <path fill-rule="evenodd" d="M5.25 2.25a.75.75 0 01.75.75v1.5H18V3a.75.75 0 011.5 0v1.5H21a.75.75 0 01.75.75v16.5a.75.75 0 01-.75.75H3a.75.75 0 01-.75-.75V5.25a.75.75 0 01.75-.75H4.5V3a.75.75 0 01.75-.75zm0 9v6.75h13.5V11.25H5.25zm0-7.5v6h13.5v-6H5.25z" clip-rule="evenodd" />
                                </svg>
                                <span class="sidebar-text whitespace-nowrap">Inventory</span>
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="Reports.html" class="flex items-center px-4 py-3 text-gray-300 hover:bg-gray-700 hover:text-white">
                            <span class="sidebar-link-container flex items-center w-full">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 mr-3 flex-shrink-0">
                                    <path d="M12.97 3.97a.75.75 0 011.06 0l7.5 7.5a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 11-1.06-1.06l6.22-6.22H3a.75.75 0 010-1.5h16.19l-6.22-6.22a.75.75 0 010-1.06z" />
                                </svg>
                                <span class="sidebar-text whitespace-nowrap">Reports</span>
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="Inquiries.html" class="flex items-center px-4 py-3 text-gray-300 hover:bg-gray-700 hover:text-white">
                            <span class="sidebar-link-container flex items-center w-full">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 mr-3 flex-shrink-0">
                                    <path fill-rule="evenodd" d="M4.804 21.644A6.707 6.707 0 006 21.75a6.721 6.721 0 003.583-1.029c.433.09.9.158 1.417.158A6.721 6.721 0 0018 20.72a6.707 6.707 0 001.196.924c.23.16.49.29.766.392A6.715 6.715 0 0021 18.75a6.715 6.715 0 00-2.234-5.02c.088-.45.134-.91.134-1.38C18.9 9.868 15.933 7 12 7S5.1 9.868 5.1 12.3c0 .47.046.93.134 1.38A6.715 6.715 0 003 18.75c0 .613.081 1.21.234 1.77.276-.102.536-.232.766-.392zM12 8.5c3.19 0 5.89 2.494 5.89 5.55 0 .28-.02.556-.059.828a.75.75 0 01-.84.69c-.201-.023-.393-.053-.575-.09a.75.75 0 01-.6-.82c.046-.28.076-.564.076-.858 0-2.24-1.99-4.05-4.442-4.05-2.452 0-4.442 1.81-4.442 4.05 0 .294.03.578.076.858a.75.75 0 01-.6.82c-.182.037-.374.067-.575.09a.75.75 0 01-.84-.69.923.923 0 01-.059-.828C6.11 10.994 8.81 8.5 12 8.5z" clip-rule="evenodd" />
                                </svg>
                                <span class="sidebar-text whitespace-nowrap">Inquiries</span>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                <a href="Healthstatistics.html" class="flex items-center px-4 py-3 text-gray-300 hover:bg-gray-700 hover:text-white">
                    <span class="sidebar-link-container flex items-center w-full">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 mr-3 flex-shrink-0">
                            <path fill-rule="evenodd" d="M4.804 21.644A6.707 6.707 0 006 21.75a6.721 6.721 0 003.583-1.029c.433.09.9.158 1.417.158A6.721 6.721 0 0018 20.72a6.707 6.707 0 001.196.924c.23.16.49.29.766.392A6.715 6.715 0 0021 18.75a6.715 6.715 0 00-2.234-5.02c.088-.45.134-.91.134-1.38C18.9 9.868 15.933 7 12 7S5.1 9.868 5.1 12.3c0 .47.046.93.134 1.38A6.715 6.715 0 003 18.75c0 .613.081 1.21.234 1.77.276-.102.536-.232.766-.392zM12 8.5c3.19 0 5.89 2.494 5.89 5.55 0 .28-.02.556-.059.828a.75.75 0 01-.84.69c-.201-.023-.393-.053-.575-.09a.75.75 0 01-.6-.82c.046-.28.076-.564.076-.858 0-2.24-1.99-4.05-4.442-4.05-2.452 0-4.442 1.81-4.442 4.05 0 .294.03.578.076.858a.75.75 0 01-.6.82c-.182.037-.374.067-.575.09a.75.75 0 01-.84-.69.923.923 0 01-.059-.828C6.11 10.994 8.81 8.5 12 8.5z" clip-rule="evenodd" />
                        </svg>
                        <span class="sidebar-text whitespace-nowrap">Statistics</span>
                    </span>
                </a>
            </li>
            
                    <li class="px-4 py-2 mt-2 text-xs font-semibold text-gray-500 uppercase tracking-wider sidebar-text">
                        Management
                    </li>
                    
                    <li>
                        <button id="content-toggle" class="w-full flex items-center justify-between px-4 py-3 bg-gray-700 text-white font-semibold">
                            <span class="sidebar-link-container flex items-center w-full">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 mr-3 flex-shrink-0">
                                    <path fill-rule="evenodd" d="M2.25 13.5a8.25 8.25 0 018.25-8.25.75.75 0 01.75.75v6.75H18a.75.75 0 01.75.75 8.25 8.25 0 01-16.5 0z" clip-rule="evenodd" />
                                    <path fill-rule="evenodd" d="M12.75 3a.75.75 0 01.75-.75 8.25 8.25 0 018.25 8.25.75.75 0 01-.75.75h-6.75a.75.75 0 01-.75-.75V3z" clip-rule="evenodd" />
                                </svg>
                                <span class="sidebar-text whitespace-nowrap">Site Content</span>
                            </span>
                            <svg id="content-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 transition-transform duration-200 sidebar-dropdown-arrow rotate-180">
                                <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.25 4.25a.75.75 0 01-1.06 0L5.23 8.29a.75.75 0 01.02-1.06z" clip-rule="evenodd" />
                            </svg>
                        </button>
                        <ul id="content-menu" class="bg-gray-700">
                            <li><a href="AdminAnnouncement.html" class="block px-10 py-2 text-sm text-teal-400 font-semibold bg-gray-600 sidebar-text">Announcements</a></li>
                            <li><a href="AdminServices.html" class="block px-10 py-2 text-sm text-gray-300 hover:bg-gray-600 hover:text-white sidebar-text">Services</a></li>
                            <li><a href="AdminFAQS.html" class="block px-10 py-2 text-sm text-gray-300 hover:bg-gray-600 hover:text-white sidebar-text">FAQs</a></li>
                        </ul>
                    </li>
                    
                    <li>
                        <button id="user-toggle" class="w-full flex items-center justify-between px-4 py-3 text-gray-300 hover:bg-gray-700 hover:text-white">
                            <span class="sidebar-link-container flex items-center w-full">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 mr-3 flex-shrink-0">
                                    <path fill-rule="evenodd" d="M18.685 19.097A9.723 9.723 0 0021.75 12c0-5.385-4.365-9.75-9.75-9.75S2.25 6.615 2.25 12a9.723 9.723 0 003.065 7.097A9.716 9.716 0 0012 21.75a9.716 9.716 0 006.685-2.653zm-12.54-1.285A7.486 7.486 0 0112 15a7.486 7.486 0 015.855 2.812A8.224 8.224 0 0112 20.25a8.224 8.224 0 01-5.855-2.438zM15.75 9a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" clip-rule="evenodd" />
                                </svg>
                                <span class="sidebar-text whitespace-nowrap">User Management</span>
                            </span>
                            <svg id="user-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 transition-transform duration-200 sidebar-dropdown-arrow">
                                <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.25 4.25a.75.75 0 01-1.06 0L5.23 8.29a.75.75 0 01.02-1.06z" clip-rule="evenodd" />
                            </svg>
                        </button>
                        <ul id="user-menu" class="hidden bg-gray-700">
                            <li><a href="DoctorsProfile.html" class="block px-10 py-2 text-sm text-gray-300 hover:bg-gray-600 hover:text-white sidebar-text">Staff</a></li>
                            <li><a href="AdminResidents.html" class="block px-10 py-2 text-sm text-gray-300 hover:bg-gray-600 hover:text-white sidebar-text">Residents</a></li>
                        </ul>
                    </li>
                </ul>
            </nav>
        </aside>
        <div id="sidebar-backdrop" class="fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden"></div>

        <div id="main-content" class="flex-1 flex flex-col overflow-hidden">
            
            <header class="h-16 bg-white shadow-sm border-b border-gray-200 flex items-center justify-between px-6 z-30 flex-shrink-0">
                <button id="sidebar-open-btn" class="lg:hidden p-1 text-gray-600 hover:text-gray-800">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
                    </svg>
                </button>
                
                <div class="hidden md:block">
                    <h1 class="text-xl font-semibold text-gray-800">Manage Announcements</h1>
                </div>
                
                <div class="flex items-center space-x-4 ml-auto">
                    <button class="p-2 bg-gray-100 rounded-full text-gray-500 hover:bg-gray-200 hover:text-gray-700 relative">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0" />
                        </svg>
                        <span class="absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full"></span>
                    </button>
                    
                    <div class="relative">
                        <button id="profile-toggle" class="flex items-center space-x-2">
                            <img src="https://placehold.co/40x40/a5f3fc/083344?text=A" alt="Admin" class="w-10 h-10 rounded-full object-cover border-2 border-gray-200">
                            <div class="hidden md:block text-left">
                                <span class="font-semibold text-sm text-gray-700">Admin User</span>
                                <span class="block text-xs text-gray-500">Administrator</span>
                            </div>
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-gray-500 hidden md:block">
                                <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.25 4.25a.75.75 0 01-1.06 0L5.23 8.29a.75.75 0 01.02-1.06z" clip-rule="evenodd" />
                            </svg>
                        </button>
                        <div id="profile-menu" class="hidden absolute right-0 top-full mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50 border border-gray-100">
                            <a href="AdminProfile.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">My Profile</a>
                            <a href="AdminSettings.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Settings</a>
                            <a href="admin_login.html" class="block px-4 py-2 text-sm text-red-600 hover:bg-gray-100">Logout</a>
                        </div>
                    </div>
                </div>
            </header>

            <main class="flex-1 overflow-y-auto p-6">
                
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                    <div class="flex flex-wrap gap-2 w-full md:w-auto">
                        <select id="filterCategory" class="bg-white border border-gray-300 text-gray-700 text-sm rounded-lg focus:ring-teal-500 focus:border-teal-500 block p-2.5">
                            <option value="all">All Categories</option>
                            <option value="Event">Events & Missions</option>
                            <option value="Program">Health Programs</option>
                            <option value="Advisory">Advisories</option>
                            <option value="Emergency">Emergency Info</option>
                        </select>
                        <select id="filterStatus" class="bg-white border border-gray-300 text-gray-700 text-sm rounded-lg focus:ring-teal-500 focus:border-teal-500 block p-2.5">
                            <option value="all">All Status</option>
                            <option value="Published">Published</option>
                            <option value="Draft">Draft</option>
                        </select>
                        <div class="relative w-full md:w-64">
                            <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
                                <svg class="w-4 h-4 text-gray-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"/>
                                </svg>
                            </div>
                            <input type="text" id="searchAnnouncement" class="block w-full p-2.5 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-white focus:ring-teal-500 focus:border-teal-500" placeholder="Search title...">
                        </div>
                        <button id="resetDbBtn" class="flex items-center justify-center py-2.5 px-4 bg-gray-200 text-gray-700 rounded-lg font-medium hover:bg-gray-300 transition shadow-sm w-full md:w-auto" title="Reset to default data">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-1">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99" />
                            </svg>
                            Reset DB
                        </button>
                    </div>
                    <button data-modal-target="addAnnouncementModal" class="flex items-center justify-center py-2 px-4 bg-teal-600 text-white rounded-lg font-medium hover:bg-teal-700 transition shadow-sm w-full md:w-auto">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 mr-2">
                            <path d="M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z" />
                        </svg>
                        New Post
                    </button>
                </div>

                <div class="bg-white rounded-lg shadow overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left text-gray-500">
                            <thead class="text-xs text-gray-700 uppercase bg-gray-50 border-b">
                                <tr>
                                    <th scope="col" class="px-6 py-3 w-1/3">Title</th>
                                    <th scope="col" class="px-6 py-3">Category</th>
                                    <th scope="col" class="px-6 py-3">Date Posted</th>
                                    <th scope="col" class="px-6 py-3">Status</th>
                                    <th scope="col" class="px-6 py-3 text-right">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="announcementTableBody">
                                <tr>
                                    <td colspan="5" class="px-6 py-4 text-center">Loading...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

            </main>
        </div>
    </div>

    <div id="addAnnouncementModal" class="modal fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black bg-opacity-50 hidden">
        <div class="modal-panel w-full max-w-2xl bg-white rounded-xl shadow-2xl border-t-4 border-teal-600">
            <form id="announcementForm">
                <input type="hidden" id="editAnnouncementId" name="id">
                <div class="p-5 border-b flex justify-between items-center">
                    <h3 class="text-2xl font-bold text-teal-800" id="modalTitle">Create New Announcement</h3>
                    <button type="button" class="p-2 text-gray-400 hover:text-gray-600" data-modal-close="addAnnouncementModal">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
                <div class="p-6 space-y-4 max-h-[70vh] overflow-y-auto">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="col-span-full">
                            <label for="postTitle" class="block text-sm font-medium text-gray-700 mb-1">Title </label>
                            <input type="text" id="postTitle" name="title" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-teal-500 focus:border-teal-500">
                        </div>
                        <div>
                            <label for="postCategory" class="block text-sm font-medium text-gray-700 mb-1">Category </label>
                            <select id="postCategory" name="category" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-teal-500 focus:border-teal-500 bg-white">
                                <option value="Event">Events & Missions</option>
                                <option value="Program">Health Programs</option>
                                <option value="Advisory">Advisories</option>
                                <option value="Emergency">Emergency Info</option>
                            </select>
                        </div>
                        <div>
                            <label for="postStatus" class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                            <select id="postStatus" name="status" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-teal-500 focus:border-teal-500 bg-white">
                                <option value="Published">Published</option>
                                <option value="Draft">Draft</option>
                            </select>
                        </div>
                        <div class="col-span-full">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Announcement Image</label>
                            <div class="flex flex-col gap-2">
                                <div class="flex items-center justify-center w-full">
                                    <label for="postImageFile" class="flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100">
                                        <div class="flex flex-col items-center justify-center pt-5 pb-6">
                                            <svg class="w-8 h-8 mb-4 text-gray-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 16">
                                                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"/>
                                            </svg>
                                            <p class="text-sm text-gray-500"><span class="font-semibold">Click to upload</span> or drag and drop</p>
                                            <p class="text-xs text-gray-500">SVG, PNG, JPG or GIF (MAX. ~500KB)</p>
                                        </div>
                                        <input id="postImageFile" type="file" class="hidden" accept="image/*" />
                                    </label>
                                </div>
                                <input type="url" id="postImage" name="image" placeholder="Or paste image URL..." class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-teal-500 focus:border-teal-500 text-sm">
                            </div>
                        </div>
                        <div class="col-span-full">
                            <label for="postContent" class="block text-sm font-medium text-gray-700 mb-1">Content </label>
                            <textarea id="postContent" name="content" rows="6" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-teal-500 focus:border-teal-500" placeholder="Write the details here..."></textarea>
                        </div>
                    </div>
                </div>
                <div class="px-6 py-4 bg-gray-50 border-t flex justify-end space-x-2 rounded-b-xl">
                    <button type="button" class="px-4 py-2 bg-white border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50" data-modal-close="addAnnouncementModal">Cancel</button>
                    <button type="submit" class="px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700">Save Post</button>
                </div>
            </form>
        </div>
    </div>

    <div id="viewAnnouncementModal" class="modal fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black bg-opacity-50 hidden">
        <div class="modal-panel w-full max-w-2xl bg-white rounded-xl shadow-2xl overflow-hidden">
            <div class="relative h-64 bg-gray-200">
                <img id="previewImage" src="" alt="Preview" class="w-full h-full object-cover">
                <button type="button" class="absolute top-4 right-4 p-2 bg-black bg-opacity-50 rounded-full text-white hover:bg-opacity-70 transition" data-modal-close="viewAnnouncementModal">
                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
            <div class="p-8">
                <div class="flex items-center gap-3 mb-4">
                    <span id="previewCategory" class="px-3 py-1 text-xs font-semibold uppercase tracking-wide rounded-full">Category</span>
                    <span id="previewDate" class="text-sm text-gray-500">Date</span>
                </div>
                <h2 id="previewTitle" class="text-3xl font-bold text-gray-900 mb-4">Title</h2>
                <div id="previewContent" class="text-gray-700 leading-relaxed space-y-4">
                    </div>
            </div>
            <div class="px-8 py-4 bg-gray-50 border-t flex justify-end">
                <button type="button" class="px-4 py-2 bg-white border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50" data-modal-close="viewAnnouncementModal">Close Preview</button>
            </div>
        </div>
    </div>

    <div id="deleteConfirmModal" class="modal fixed inset-0 z-[110] flex items-center justify-center p-4 bg-black bg-opacity-70 hidden">
        <div class="modal-panel w-full max-w-sm bg-white rounded-xl shadow-2xl border-t-4 border-red-600">
            <input type="hidden" id="deletePostId">
            <div class="p-5 border-b text-center">
                <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4">
                    <svg class="h-6 w-6 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                    </svg>
                </div>
                <h3 class="text-xl font-bold text-gray-900">Delete Post?</h3>
            </div>
            <div class="p-6 text-center">
                <p class="text-gray-700">Are you sure you want to delete <strong id="deletePostTitle">Title</strong>?</p>
                <p class="mt-2 text-sm text-gray-500">This action cannot be undone.</p>
            </div>
            <div class="px-6 py-4 bg-gray-50 border-t flex justify-between space-x-2 rounded-b-xl">
                <button type="button" class="px-4 py-2 bg-white border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50" data-modal-close="deleteConfirmModal">Cancel</button>
                <button type="button" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700" id="confirmDeleteBtn">Yes, Delete</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- 1. SIMPLE IN-BROWSER DATABASE CLASS (USING LocalStorage) ---
            const DB_KEY = 'bhcms_announcements_db';
            
            // Default data for initial load or reset
            const DEFAULT_DATA = [
                { id: 1, title: 'Free Flu Vaccine Drive', category: 'Event', date: '2025-10-25', status: 'Published', image: 'https://www.reuters.com/resizer/v2/QDYOKJEFTNPZXMX5PWFGAG2Q2Q.jpg?auth=d70e30211af52a29f2f486602f9961bbad8a907404d07a290b5abc1b1de42131', content: 'This Saturday, 9AM at the barangay court. Open for all seniors and children. Protect yourself before the cold season begins!' },
                { id: 2, title: 'Dental Cleaning Mission', category: 'Event', date: '2025-10-28', status: 'Published', image: 'https://tzuchi-en-backend.storage.googleapis.com/content/images/2023/06/1-PHO.jpg', content: 'Free dental checkups and cleaning available this Friday. Limited slots, first come, first served.' },
                { id: 3, title: 'Dengue Awareness Seminar', category: 'Event', date: '2025-11-01', status: 'Published', image: 'https://punto.com.ph/wp-content/uploads/2023/09/received_150305088123714.jpeg', content: 'Learn how to prevent dengue in your homes and community. All residents are invited.' },
                { id: 4, title: 'Oplan Timbang', category: 'Program', date: '2025-11-05', status: 'Published', image: 'https://oldwebsite.bayambang.gov.ph/wp-content/uploads/2017/05/IMG_4851.jpg', content: 'Monthly monitoring of children aged 0-5. Please bring your child\'s health book.' },
                { id: 5, title: 'Emergency Hotline Update', category: 'Emergency', date: '2025-11-10', status: 'Published', image: 'https://binangonan.gov.ph/wp-content/uploads/2025/08/MAINLAND-BARANGAY-EMERGENCY-HOTLINES.png', content: 'We have updated our emergency contact numbers. Please save them.' },
                { id: 6, title: 'Rainy Season Advisory', category: 'Advisory', date: '2025-11-15', status: 'Draft', image: 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTdauzncrdzN0DgeDHAjDnGBeBsD5ofH2MBXg&s', content: 'Tips to stay healthy and avoid common illnesses during the rainy season.' }
            ];

            // This class encapsulates all LocalStorage interaction for the data
            class SimpleDB {
                static load() {
                    const storedData = localStorage.getItem(DB_KEY);
                    if (storedData) {
                        return JSON.parse(storedData);
                    }
                    // If no data, initialize with defaults and save them.
                    const initialData = [...DEFAULT_DATA];
                    SimpleDB.save(initialData);
                    return initialData;
                }

                static save(data) {
                    try {
                        localStorage.setItem(DB_KEY, JSON.stringify(data));
                    } catch (e) {
                        alert("Storage full! Image might be too large. Try using an image URL instead of uploading.");
                        console.error("Local Storage Error:", e);
                    }
                }

                static reset() {
                    localStorage.removeItem(DB_KEY);
                    return SimpleDB.load();
                }
            }

            let announcements = SimpleDB.load(); // Initialize and load data immediately

            // --- 2. DOM Elements & Initial Setup ---
            const tableBody = document.getElementById('announcementTableBody');
            const filterCategory = document.getElementById('filterCategory');
            const filterStatus = document.getElementById('filterStatus');
            const searchInput = document.getElementById('searchAnnouncement');
            const formModal = document.getElementById('announcementForm');
            const confirmDeleteBtn = document.getElementById('confirmDeleteBtn');
            const postImageFile = document.getElementById('postImageFile');
            const resetDbBtn = document.getElementById('resetDbBtn'); 
            let uploadedImageData = null; 


            // --- Sidebar Toggle Logic (Mobile/Tablet) ---
            const sidebarOpenBtn = document.getElementById('sidebar-open-btn');
            const sidebarCloseBtn = document.getElementById('sidebar-close-btn');
            const sidebarBackdrop = document.getElementById('sidebar-backdrop');
            const contentToggle = document.getElementById('content-toggle');
            const contentMenu = document.getElementById('content-menu');
            const contentArrow = document.getElementById('content-arrow');
            const userToggle = document.getElementById('user-toggle');
            const userMenu = document.getElementById('user-menu');
            const userArrow = document.getElementById('user-arrow');
            const profileToggle = document.getElementById('profile-toggle');
            const profileMenu = document.getElementById('profile-menu');
            
            // Mobile Menu Open/Close
            if (sidebarOpenBtn) sidebarOpenBtn.addEventListener('click', () => document.body.classList.add('sidebar-open'));
            if (sidebarCloseBtn) sidebarCloseBtn.addEventListener('click', () => document.body.classList.remove('sidebar-open'));
            if (sidebarBackdrop) sidebarBackdrop.addEventListener('click', () => document.body.classList.remove('sidebar-open'));

            // Dropdown Toggles (Site Content)
            if (contentToggle) contentToggle.addEventListener('click', () => {
                const isExpanded = contentMenu.classList.toggle('hidden');
                if (isExpanded) {
                    contentArrow.classList.remove('rotate-180');
                    contentToggle.classList.remove('bg-gray-700', 'text-white', 'font-semibold');
                    contentToggle.classList.add('hover:bg-gray-700', 'hover:text-white');
                } else {
                    contentArrow.classList.add('rotate-180');
                    contentToggle.classList.add('bg-gray-700', 'text-white', 'font-semibold');
                    contentToggle.classList.remove('hover:bg-gray-700', 'hover:text-white');
                }
            });
            // Dropdown Toggles (User Management)
            if (userToggle) userToggle.addEventListener('click', () => {
                const isExpanded = userMenu.classList.toggle('hidden');
                if (isExpanded) {
                    userArrow.classList.remove('rotate-180');
                    userToggle.classList.remove('bg-gray-700', 'text-white', 'font-semibold');
                } else {
                    userArrow.classList.add('rotate-180');
                    userToggle.classList.add('bg-gray-700', 'text-white', 'font-semibold');
                }
            });

            // Profile Dropdown Toggle
            if (profileToggle) profileToggle.addEventListener('click', () => {
                profileMenu.classList.toggle('hidden');
            });

            // Close profile menu when clicking outside
            document.addEventListener('click', (event) => {
                if (profileMenu && profileToggle && !profileMenu.contains(event.target) && !profileToggle.contains(event.target)) {
                    profileMenu.classList.add('hidden');
                }
            });


            // --- Modal Logic ---
            function openModal(modalId) {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.remove('hidden');
                    modal.classList.add('flex');
                    document.body.style.overflow = 'hidden';
                }
            }

            function closeModal(modalId) {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.add('hidden');
                    modal.classList.remove('flex');
                    document.body.style.overflow = 'auto';
                }
            }

            // Global listeners for modal opening buttons
            document.querySelectorAll('[data-modal-target]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    if(btn.dataset.modalTarget === 'addAnnouncementModal') {
                        document.getElementById('modalTitle').textContent = 'Create New Announcement';
                        formModal.reset();
                        document.getElementById('editAnnouncementId').value = '';
                        uploadedImageData = null; 
                    }
                    openModal(btn.dataset.modalTarget);
                });
            });

            // Global listeners for modal closing buttons
            document.querySelectorAll('[data-modal-close]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    closeModal(btn.closest('.modal').id);
                });
            });

            // --- File Upload Logic (Converts file to Base64 for LocalStorage) ---
            if (postImageFile) {
                postImageFile.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        // Check file size (Limit to ~500KB for LocalStorage safety)
                        if (file.size > 500000) {
                            alert("File is too large for local storage! Please use a smaller image or an Image URL.");
                            this.value = ""; 
                            return;
                        }
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            uploadedImageData = e.target.result;
                            document.getElementById('postImage').value = ''; // Clear URL field if file is uploaded
                        }
                        reader.readAsDataURL(file);
                    }
                });
            }

            // --- Render Table ---
            function renderTable() {
                const category = filterCategory.value;
                const status = filterStatus.value;
                const search = searchInput.value.toLowerCase();

                const filtered = announcements.filter(item => {
                    const matchCat = category === 'all' || item.category === category;
                    const matchStat = status === 'all' || item.status === status;
                    const matchSearch = item.title.toLowerCase().includes(search);
                    return matchCat && matchStat && matchSearch;
                });

                tableBody.innerHTML = '';

                if (filtered.length === 0) {
                    tableBody.innerHTML = '<tr><td colspan="5" class="px-6 py-4 text-center text-gray-500">No announcements found matching your filters.</td></tr>';
                    return;
                }
                
                // Sort by ID descending (newest first)
                filtered.sort((a, b) => b.id - a.id);


                filtered.forEach(item => {
                    const row = document.createElement('tr');
                    row.className = 'bg-white border-b hover:bg-gray-50';
                    
                    let statusClass = item.status === 'Published' 
                        ? 'bg-green-100 text-green-800' 
                        : 'bg-gray-100 text-gray-800';

                    let catClass = 'bg-gray-100 text-gray-800';
                    if (item.category === 'Event') catClass = 'bg-teal-100 text-teal-800';
                    else if (item.category === 'Program') catClass = 'bg-indigo-100 text-indigo-800';
                    else if (item.category === 'Emergency') catClass = 'bg-red-100 text-red-800';
                    else if (item.category === 'Advisory') catClass = 'bg-yellow-100 text-yellow-800';

                    row.innerHTML = `
                        <td class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap">${item.title}</td>
                        <td class="px-6 py-4"><span class="${catClass} text-xs font-medium mr-2 px-2.5 py-0.5 rounded">${item.category}</span></td>
                        <td class="px-6 py-4">${item.date}</td>
                        <td class="px-6 py-4"><span class="${statusClass} text-xs font-medium mr-2 px-2.5 py-0.5 rounded">${item.status}</span></td>
                        <td class="px-6 py-4 text-right">
                            <button class="font-medium text-blue-600 hover:underline mr-3 btn-view" data-id="${item.id}">View</button>
                            <button class="font-medium text-teal-600 hover:underline mr-3 btn-edit" data-id="${item.id}">Edit</button>
                            <button class="font-medium text-red-600 hover:underline btn-delete" data-id="${item.id}">Delete</button>
                        </td>
                    `;
                    tableBody.appendChild(row);
                });

                attachActionListeners();
            }

            function attachActionListeners() {
                // View button logic
                document.querySelectorAll('.btn-view').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const id = parseInt(btn.dataset.id);
                        const item = announcements.find(a => a.id === id);
                        if(item) {
                            document.getElementById('previewTitle').textContent = item.title;
                            document.getElementById('previewDate').textContent = item.date;
                            document.getElementById('previewContent').textContent = item.content;
                            document.getElementById('previewImage').src = item.image || 'https://placehold.co/600x400/e2e8f0/1f2937?text=No+Image';
                            
                            const catBadge = document.getElementById('previewCategory');
                            catBadge.textContent = item.category;
                            catBadge.className = 'px-3 py-1 text-xs font-semibold uppercase tracking-wide rounded-full';
                            // Apply badge color classes
                            if (item.category === 'Event') catBadge.classList.add('bg-teal-100', 'text-teal-800');
                            else if (item.category === 'Program') catBadge.classList.add('bg-indigo-100', 'text-indigo-800');
                            else if (item.category === 'Emergency') catBadge.classList.add('bg-red-100', 'text-red-800');
                            else if (item.category === 'Advisory') catBadge.classList.add('bg-yellow-100', 'text-yellow-800');

                            openModal('viewAnnouncementModal');
                        }
                    });
                });

                // Edit button logic
                document.querySelectorAll('.btn-edit').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const id = parseInt(btn.dataset.id);
                        const item = announcements.find(a => a.id === id);
                        if(item) {
                            document.getElementById('modalTitle').textContent = 'Edit Announcement';
                            document.getElementById('editAnnouncementId').value = item.id;
                            document.getElementById('postTitle').value = item.title;
                            document.getElementById('postCategory').value = item.category;
                            document.getElementById('postStatus').value = item.status;
                            
                            // Check if image is a Base64 data URL (uploaded file) or a regular URL
                            if (item.image && item.image.startsWith('data:')) {
                                document.getElementById('postImage').value = ''; // Clear URL field
                                uploadedImageData = item.image; // Keep the existing Base64 data
                            } else {
                                document.getElementById('postImage').value = item.image; // Set URL field
                                uploadedImageData = null; 
                            }
                            
                            document.getElementById('postContent').value = item.content;
                            postImageFile.value = ""; // Clear file input
                            openModal('addAnnouncementModal');
                        }
                    });
                });

                // Delete button logic (opens confirmation modal)
                document.querySelectorAll('.btn-delete').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const id = parseInt(btn.dataset.id);
                        const item = announcements.find(a => a.id === id);
                        if(item) {
                            document.getElementById('deletePostId').value = item.id;
                            document.getElementById('deletePostTitle').textContent = item.title;
                            openModal('deleteConfirmModal');
                        }
                    });
                });
            }

            // --- Form Handlers ---
            formModal.addEventListener('submit', (e) => {
                e.preventDefault();
                const formData = new FormData(formModal);
                const id = document.getElementById('editAnnouncementId').value;
                
                // Determine the final image source: 1. Uploaded File, 2. URL Input, 3. Previous value (during edit)
                let finalImage = uploadedImageData; 
                if (!finalImage) {
                    const urlInput = formData.get('image');
                    if(urlInput) finalImage = urlInput;
                }
                
                const newPost = {
                    id: id ? parseInt(id) : Date.now(),
                    title: formData.get('title'),
                    category: formData.get('category'),
                    status: formData.get('status'),
                    image: finalImage,
                    content: formData.get('content'),
                    // If editing, preserve old date. If new, use today's date.
                    date: id ? announcements.find(a => a.id == id).date : new Date().toISOString().split('T')[0]
                };

                if (id) {
                    // Update existing post
                    const index = announcements.findIndex(a => a.id == id);
                    // If no new image/URL provided, keep the existing one
                    if (!newPost.image) {
                        newPost.image = announcements[index].image; 
                    }
                    announcements[index] = newPost;
                } else {
                    // Create new post
                    if (!newPost.image) newPost.image = 'https://placehold.co/600x400/e2e8f0/1f2937?text=No+Image';
                    announcements.unshift(newPost);
                }

                SimpleDB.save(announcements); // **Database Write**
                uploadedImageData = null; // Clear uploaded data after save
                closeModal('addAnnouncementModal');
                renderTable();
            });

            // Delete confirmation handler
            confirmDeleteBtn.addEventListener('click', () => {
                const id = parseInt(document.getElementById('deletePostId').value);
                announcements = announcements.filter(a => a.id !== id);
                SimpleDB.save(announcements); // **Database Write**
                closeModal('deleteConfirmModal');
                renderTable();
            });
            
            // --- Reset Handler ---
            if(resetDbBtn) resetDbBtn.addEventListener('click', () => {
                if(confirm("Are you sure you want to reset all data to default? This will delete your changes.")) {
                    announcements = SimpleDB.reset(); // **Database Reset**
                    renderTable();
                    alert("Database reset to default.");
                }
            });

            // --- Filter Listeners (Triggers table re-render on change) ---
            filterCategory.addEventListener('change', renderTable);
            filterStatus.addEventListener('change', renderTable);
            searchInput.addEventListener('input', renderTable);

            // --- Initial Load ---
            renderTable();
        });
    </script>
</body>
</html>